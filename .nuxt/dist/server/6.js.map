{"version":3,"file":"6.js","sources":["webpack:///./utils/api.js","webpack:///./pages/settings/index.vue?a6cc","webpack:///./pages/settings/index.vue","webpack:///./pages/settings/index.vue?1790","webpack:///./pages/settings/index.vue?27c9"],"sourcesContent":["import { Axios } from '@/plugins/http.js';\r\n\r\n//登录\r\nexport const signIn = (params) =>\r\n\tAxios({\r\n\t\turl: '/api/users/login',\r\n\t\tdata: params,\r\n\t});\r\n\r\n// 注册\r\nexport const register = (params) =>\r\n\tAxios({\r\n\t\turl: '/api/users',\r\n\t\tdata: params,\r\n\t});\r\n\r\n// 获取文章列表\r\nexport const getArticles = (params) =>\r\n\tAxios({\r\n\t\tmethod: 'get',\r\n\t\turl: '/api/articles',\r\n\t\tparams,\r\n\t});\r\n\r\n// 获取标签列表\r\nexport const getTags = (params) =>\r\n\tAxios({\r\n\t\tmethod: 'get',\r\n\t\turl: '/api/tags',\r\n\t\tparams,\r\n\t});\r\n\r\n// 获取个人关注的文章列表\r\nexport const getFeedArticle = (params) =>\r\n\tAxios({\r\n\t\tmethod: 'get',\r\n\t\turl: '/api/articles/feed',\r\n\t\tparams,\r\n\t});\r\n\r\n// 点赞\r\nexport const addFavorite = (params) =>\r\n\tAxios({\r\n\t\tmethod: 'post',\r\n\t\turl: `/api/articles/${params}/favorite`,\r\n\t});\r\n\r\n// 删除点赞\r\nexport const delFavorite = (params) =>\r\n\tAxios({\r\n\t\tmethod: 'delete',\r\n\t\turl: `/api/articles/${params}/favorite`,\r\n\t});\r\n\r\n// 获取文章详情\r\nexport const getArticle = (params) =>\r\n\tAxios({\r\n\t\tmethod: 'get',\r\n\t\turl: `/api/articles/${params}`,\r\n\t});\r\n\r\n//获取文章评论列表\r\nexport const getComments = (params) =>\r\n\tAxios({\r\n\t\tmethod: 'get',\r\n\t\turl: `/api/articles/${params}/comments`,\r\n\t});\r\n\r\n//发表评论\r\nexport const makeComment = (params) =>\r\n\tAxios({\r\n\t\tmethod: 'post',\r\n\t\turl: `/api/articles/${params.article}/comments`,\r\n\t\tdata: params.data,\r\n\t});\r\n\r\n// 删除评论\r\nexport const delComment = (params) =>\r\n\tAxios({\r\n\t\tmethod: 'delete',\r\n\t\turl: `/api/articles/${params.slug}/comments/${params.id}`,\r\n\t});\r\n\r\n// addFollow\r\nexport const addFollow = (params) =>\r\n\tAxios({\r\n\t\turl: `api/profiles/${params}/follow`,\r\n\t});\r\n\r\n// delFollow\r\nexport const delFollow = (params) =>\r\n\tAxios({\r\n\t\tmethod: 'delete',\r\n\t\turl: `api/profiles/${params}/follow`,\r\n\t});\r\n\r\n// 设置个人信息\r\nexport const settingUser = (params) =>\r\n\tAxios({\r\n\t\tmethod: 'put',\r\n\t\turl: '/api/ersu',\r\n\t\tdata: params,\r\n\t});\r\n\r\n//更新个人信息\r\nexport const updateUser = (params) =>\r\n\tAxios({\r\n\t\tmethod: 'put',\r\n\t\turl: '/api/user',\r\n\t\tdata: params,\r\n\t});\r\n\r\n// 获取个人信息\r\nexport const getUserInfo = (params) =>\r\n\tAxios({\r\n\t\tmethod: 'get',\r\n\t\turl: `/api/profiles/${params}`,\r\n\t});\r\n\r\n// 发布文章\r\nexport const pubArticle = (params) => Axios({\r\n    method:'post',\r\n    url:'/api/articles',\r\n    data:params\r\n})\r\n\r\n// 删除文章\r\nexport const delArticle = (params) => Axios({\r\n    method:'delete',\r\n    url:`/api/articles/${params}`\r\n})\r\n\r\n// 修改文章\r\nexport const updateArticle = (params) => Axios({\r\n    method:'put',\r\n    url:`/api/articles/${params.slug}`,\r\n    data:params.data\r\n})","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"settings-page\"},[_vm._ssrNode(\"<div class=\\\"container page\\\"><div class=\\\"row\\\"><div class=\\\"col-md-6 offset-md-3 col-xs-12\\\"><h1 class=\\\"text-xs-center\\\">Your Settings</h1> \"+((_vm.errMsg)?(\"<ul class=\\\"error-messages\\\"><li>\"+_vm._ssrEscape(_vm._s(_vm.errMsg))+\"</li></ul>\"):\"<!---->\")+\" <form><fieldset><fieldset class=\\\"form-group\\\"><input type=\\\"text\\\" placeholder=\\\"URL of profile picture\\\"\"+(_vm._ssrAttr(\"disabled\",_vm.submmit))+(_vm._ssrAttr(\"value\",(_vm.user.image)))+\" class=\\\"form-control\\\"></fieldset> <fieldset class=\\\"form-group\\\"><input type=\\\"text\\\" placeholder=\\\"Your Name\\\"\"+(_vm._ssrAttr(\"disabled\",_vm.submmit))+(_vm._ssrAttr(\"value\",(_vm.user.username)))+\" class=\\\"form-control form-control-lg\\\"></fieldset> <fieldset class=\\\"form-group\\\"><textarea rows=\\\"8\\\" placeholder=\\\"Short bio about you\\\"\"+(_vm._ssrAttr(\"disabled\",_vm.submmit))+\" class=\\\"form-control form-control-lg\\\">\"+_vm._ssrEscape(_vm._s(_vm.user.bo))+\"</textarea></fieldset> <fieldset class=\\\"form-group\\\"><input type=\\\"text\\\" placeholder=\\\"Email\\\"\"+(_vm._ssrAttr(\"disabled\",_vm.submmit))+(_vm._ssrAttr(\"value\",(_vm.user.email)))+\" class=\\\"form-control form-control-lg\\\"></fieldset> <fieldset class=\\\"form-group\\\"><input type=\\\"password\\\" placeholder=\\\"new Password\\\"\"+(_vm._ssrAttr(\"disabled\",_vm.submmit))+(_vm._ssrAttr(\"value\",(_vm.password)))+\" class=\\\"form-control form-control-lg\\\"></fieldset> <button\"+(_vm._ssrAttr(\"disabled\",_vm.submmit))+\" class=\\\"btn btn-lg btn-primary pull-xs-right\\\">\\n\\t\\t\\t\\t\\t\\t\\tUpdate Settings\\n\\t\\t\\t\\t\\t\\t</button></fieldset></form> <hr> <button class=\\\"btn btn-outline-danger\\\">\\n\\t\\t\\t\\t\\tOr click here to logout.\\n\\t\\t\\t\\t</button></div></div></div>\")])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport { mapMutations } from 'vuex';\r\nimport { updateUser } from '@/utils/api.js';\r\nconst Cookie = process.client ? require('js-cookie') : undefined;\r\nexport default {\r\n\tmiddleware: 'authenticated',\r\n\tname: 'settings',\r\n\tasyncData({ store }) {\r\n\t\treturn {\r\n\t\t\tuser: store.state.user,\r\n\t\t};\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tpassword: '', //密码\r\n\t\t\tsubmmit: false, //是否在提交\r\n\t\t\terrMsg: '',\r\n\t\t};\r\n\t},\r\n\tmethods: {\r\n\t\t...mapMutations(['setUser']),\r\n\t\t// 退出登录\r\n\t\tloginOut() {\r\n\t\t\tthis.setUser(null);\r\n\t\t\tCookie.remove('user');\r\n\t\t\tthis.$router.replace('/');\r\n\t\t},\r\n\t\t// 更新个人信息\r\n\t\treplaceUser() {\r\n\t\t\tthis.submmit = true;\r\n\t\t\tlet { bio, email, image, username } = this.user;\r\n\t\t\tlet userInfo = {\r\n\t\t\t\tbio,\r\n\t\t\t\temail,\r\n\t\t\t\timage,\r\n\t\t\t\tusername,\r\n\t\t\t};\r\n\t\t\tif (this.password) {\r\n\t\t\t\tuserInfo.password = this.password;\r\n\t\t\t}\r\n\t\t\tupdateUser({\r\n\t\t\t\tuser: { ...userInfo },\r\n\t\t\t})\r\n\t\t\t\t.then((res) => {\r\n\t\t\t\t\tthis.setUser(res.user);\r\n\t\t\t\t\tCookie.set('user', res.user);\r\n\t\t\t\t\tthis.submmit = false;\r\n\t\t\t\t\tthis.$router.push(`/profile/${res.user.username}`);\r\n\t\t\t\t})\r\n\t\t\t\t.catch((e) => {\r\n\t\t\t\t\tthis.errMsg = e;\r\n\t\t\t\t\tthis.submmit = false;\r\n\t\t\t\t});\r\n\t\t},\r\n\t},\r\n};\r\n","import mod from \"-!../../node_modules/babel-loader/lib/index.js??ref--2-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js??ref--2-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=3e2b6fe2&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  \"4995e1fb\"\n  \n)\n\nexport default component.exports"],"mappings":";;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AAEA;AACA;AAFA;AACA;AAKA;AAEA;AACA;AAFA;AACA;AAKA;AAEA;AACA;AACA;AAHA;AACA;AAMA;AAEA;AACA;AACA;AAHA;AACA;AAMA;AAEA;AACA;AACA;AAHA;AACA;AAMA;AAEA;AACA;AAFA;AACA;AAKA;AAEA;AACA;AAFA;AACA;AAKA;AAEA;AACA;AAFA;AACA;AAKA;AAEA;AACA;AAFA;AACA;AAKA;AAEA;AACA;AACA;AAHA;AACA;AAMA;AAEA;AACA;AAFA;AACA;AAKA;AAEA;AADA;AACA;AAIA;AAEA;AACA;AAFA;AACA;AAKA;AAEA;AACA;AACA;AAHA;AACA;AAMA;AAEA;AACA;AACA;AAHA;AACA;AAMA;AAEA;AACA;AAFA;AACA;AAKA;AACA;AACA;AACA;AAHA;AACA;AAMA;AACA;AACA;AAFA;AACA;AAKA;AACA;AACA;AACA;AAHA;;;;;;;;;;;;ACrIA;AACA;AACA;;;;;;;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AADA;AAGA;AACA;AAAA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAHA;AAKA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAJA;AACA;AAKA;AACA;AACA;AACA;AAAA;AACA;AAAA;AADA;AAIA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAnCA;AAfA;;AC9EA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}